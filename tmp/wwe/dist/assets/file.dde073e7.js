import{_ as e}from"./V-Breadcrumb.vue_vue&type=script&setup=true&lang.95222eda.js";import{_ as a}from"./Eventsource.vue_vue&type=script&setup=true&lang.2ffe835f.js";import{a as s,_ as t}from"./V-Field.vue_vue&type=script&setup=true&lang.50df6a27.js";import{_ as r}from"./V-Button.vue_vue&type=script&setup=true&lang.7d7c3fd2.js";import{a as l,c as o,d as i,u as c}from"./index.670b29b2.js";import{u as n}from"./useNotyf.8c9a8697.js";import{B as p}from"./base64.8e96393c.js";import{B as u,C as d,d as v,r as m,a as j,v as f,W as h,j as _,k as g,n as b,u as y,E as k,U as w,A as x,F as V,S as B,P as C,$ as E,l as I,Q as P,m as U}from"./vendor.6243191d.js";import{_ as $}from"./V-Loader.vue_vue&type=script&setup=true&lang.152a1df5.js";import{_ as S}from"./V-Modal.vue_vue&type=script&setup=true&lang.13c249d1.js";import{a as q,t as F}from"./activeSidebarState.4b53b430.js";const z=E();u("data-v-a420f3dc");const D={class:"page-content-inner"},L={class:"list-view-toolbar"},R={class:"path-info"},M={key:0},W=b("em",null,"/",-1),A={key:0,class:"buttons"},N={key:0,class:"fas fa-spinner fa-pulse"},Q={class:"list-view-toolbar"},T={key:0,class:"file-card"};d();var G=v({expose:[],setup(e){const c=n(),u=l();o();const d=i();m(!1),m("");const v=m(!1),E=m(u.query.branch||"master"),U=m(u.query.filepath||"");j([E,U],((e,a)=>{d.dispatch("user/getProjectFile",{id:u.params.projectid,branch:E.value,dir_path:U.value})}));const $=f((()=>d.state.user.file)),S=f((()=>d.state.user.project)),q=f((()=>d.getters["user/getSimpleBranches"]));f((()=>d.state.user.tags));const F=f((()=>d.state.channel.user));h((()=>{d.dispatch("user/getProjectFile",{id:u.params.projectid,branch:E.value,dir_path:U.value}),d.dispatch("user/getBranches",{id:u.params.projectid,simple:!1}),d.dispatch("user/getTags",{id:u.params.projectid,simple:!1})}));const G=e=>{"successed"===e.status&&d.dispatch("channel/getProfile").then((()=>{v.value&&(v.value=!1,d.dispatch("user/getEditerUrl",{id:u.params.projectid}).then((e=>{const a=`${e.msg}?project_id=${u.params.projectid}`;window.open(a,"_blank")})))}))},H=e=>e.split("/").slice(-1)[0];return(e,l)=>{const o=a,i=I("Multiselect"),n=s,m=t,j=I("RouterLink"),f=r,h=P("tooltip");return _(),g("div",null,[b(o,{topic:"attach_disk",onmessage:G}),b("div",D,[b("div",L,[b(m,{class:"is-autocomplete-select"},{default:z((()=>[b(n,{icon:"feather:search"},{default:z((()=>[b(i,{modelValue:E.value,"onUpdate:modelValue":l[1]||(l[1]=e=>E.value=e),options:y(q),placeholder:"Search Branch...",searchable:!0},null,8,["modelValue","options"])])),_:1})])),_:1}),b("div",R,[b(j,{to:{name:"user-projects-projectid-files",params:{projectid:y(S).project_id},query:{dir_path:""}}},{default:z((()=>[k(w(y(S).repo_name),1)])),_:1},8,["to"]),U.value?(_(),g("em",M,"/")):x("",!0),U.value?(_(!0),g(V,{key:1},B((K=U.value,K.split("/").slice(0,-1)),((e,a)=>(_(),g("span",null,[b(j,{to:{name:"user-projects-projectid-files",params:{projectid:y(S).project_id},query:{dir_path:U.value.split("/").slice(0,a+1).join("/")}}},{default:z((()=>[k(w(e),1)])),_:2},1032,["to"]),W])))),256)):x("",!0),b("span",null,w(H(U.value)),1)]),y(S)?(_(),g("div",A,[C(b(f,{onClick:l[2]||(l[2]=e=>(v.value=!0,void(1===F.value.init_status&&F.value.edge_id?d.dispatch("user/getEditerUrl",{id:u.params.projectid}).then((e=>{v.value=!1;const a=`${e.msg}${/\?/.test(e.msg)?"&":"?"}project_id=${u.params.projectid}`;window.open(a,"_blank")}),(()=>{v.value=!1})):c.warning("环境没有初始化，请稍候...")))),color:"primary",elevated:"",disabled:v.value},{default:z((()=>[v.value?(_(),g("i",N)):x("",!0),k(" "+w(1!==y(S).level?"WebIDE":"可视化IDE"),1)])),_:1},8,["disabled"]),[[h,"IDE将会在新的窗口中打开，请勿阻止浏览器弹窗",void 0,{left:!0,warning:!0}]])])):x("",!0)]),b("div",Q,[b("p",null,w(y(S).desc||"暂无项目描述信息。"),1)]),y($).name?(_(),g("div",T,[b("pre",null,w((J=y($).content,decodeURIComponent(encodeURIComponent(p.decode(J.replace(/-/g,"+").replace(/_/g,"/")))))),1)])):x("",!0)])]);var J,K}}});G.__scopeId="data-v-a420f3dc";const H={class:"page-title has-text-centered"},J={class:"menu-toggle has-chevron"},K=b("span",{class:"rotate"},[b("i",{class:"icon-line-top"}),b("i",{class:"icon-line-center"}),b("i",{class:"icon-line-bottom"})],-1),O=b("div",{class:"title-wrap"},[b("h1",{class:"title is-4"},"代码管理")],-1),X={class:"page-content-inner"},Y={class:"breadcrumb-box"},Z=b("i",{class:"iconify","data-icon":"feather:corner-down-left"},null,-1),ee={key:0,class:"public-key-box"},ae={class:"pre-box"};var se=v({expose:[],setup(a){const s=l(),t=o(),r=i(),n=m(!0);c({title:"代码管理"});const p=m(!1),u=f((()=>r.state.user.project)),d=m();return h((()=>{Promise.all([r.dispatch("user/getProject",s.params.projectid)]).then((()=>{q.value=2===u.value.level?"none":"projects",d.value=[{icon:"feather:home",hideLabel:!0,to:{name:"user-projects"}},{label:"项目列表",to:{name:"user-projects"}},{label:u.value.repo_name,to:{name:"user-projects-projectid-files",params:{projectid:s.params.projectid}}},{label:"代码管理"}],n.value=!1}))})),(a,s)=>{const r=e,l=G,o=$,i=S;return _(),g("div",null,[b("div",H,[b("div",{class:"vuero-hamburger nav-trigger push-resize",onClick:s[1]||(s[1]=e=>{u.value&&2===u.value.level?F("none"):F("projects")})},[b("span",J,[b("span",{class:[["projects"===y(q)&&"active"],"icon-box-toggle"]},[K],2)])]),O]),b("div",X,[b(o,{size:"large",active:n.value},{default:U((()=>[b("div",Y,[d.value?(_(),g(r,{key:0,items:d.value,separator:"bullet","with-icons":""},null,8,["items"])):x("",!0),b("div",{onClick:s[2]||(s[2]=()=>y(t).back())},[Z])]),b(l)])),_:1},8,["active"])]),b(i,{open:p.value,size:"large",actions:"center",title:"查看公钥",onClose:s[3]||(s[3]=e=>p.value=!1)},{content:U((()=>[y(u).deploy_key?(_(),g("div",ee,[b("div",ae,[b("pre",null,w(y(u).deploy_key.public_key),1)])])):x("",!0)])),action:U((()=>[])),_:1},8,["open"])])}}});export default se;
