var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable,t=(a,l,s)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[l]=s,i=(e,i)=>{for(var r in i||(i={}))a.call(i,r)&&t(e,r,i[r]);if(l)for(var r of l(i))s.call(i,r)&&t(e,r,i[r]);return e};import{_ as r}from"./V-Breadcrumb.vue_vue&type=script&setup=true&lang.95222eda.js";import{_ as o}from"./V-Button.vue_vue&type=script&setup=true&lang.7d7c3fd2.js";import{_ as n,a as d}from"./V-Field.vue_vue&type=script&setup=true&lang.50df6a27.js";import{_ as c}from"./V-Buttons.vue_vue&type=script&setup=true&lang.88c78073.js";import{_ as u}from"./V-Icon.vue_vue&type=script&setup=true&lang.7e1a2cfa.js";import{u as p}from"./useDropdown.490deeca.js";import{B as m,C as v,d as g,j as f,k as b,D as h,u as y,n as k,U as _,A as j,_ as w,a5 as x,r as C,b as q,v as O,O as M,m as P,F as B,S as F,E as S,P as V,X as z,W as R}from"./vendor.6243191d.js";import{a as D,c as A,d as E,u as I}from"./index.670b29b2.js";import{_ as T}from"./V-Loader.vue_vue&type=script&setup=true&lang.152a1df5.js";import{a as U,t as $}from"./activeSidebarState.4b53b430.js";m("data-v-68ae80e6");const L={key:0},W={class:"dropdown-menu",role:"menu"},X={class:"dropdown-content"},G=x('<a href="#" class="dropdown-item" data-v-68ae80e6> Dropdown item </a><a href="#" class="dropdown-item" data-v-68ae80e6> Other dropdown item </a><a href="#" class="dropdown-item" data-v-68ae80e6> Active dropdown item </a><a href="#" class="dropdown-item" data-v-68ae80e6> Other dropdown item </a><hr class="dropdown-divider" data-v-68ae80e6><a href="#" class="dropdown-item" data-v-68ae80e6> With a divider </a>',6);v();var H=g({expose:[],inheritAttrs:!1,props:{title:{type:String,default:void 0},up:{type:Boolean,default:!1},right:{type:Boolean,default:!1},dots:{type:Boolean,default:!1},modern:{type:Boolean,default:!1},spaced:{type:Boolean,default:!1}},setup(e){const{dropdownElement:a,open:l,close:s,toggle:t,isOpen:i}=p();return(r,o)=>{const n=u;return f(),b("div",{ref:a,class:[[y(i)&&"is-active",e.right&&"is-right",e.up&&"is-up",e.dots&&"is-dots",e.modern&&"is-modern",e.spaced&&"is-spaced"],"dropdown dropdown-trigger"]},[h(r.$slots,"button",{open:y(l),close:y(s),toggle:y(t),isOpen:y(i)},(()=>[k("button",w(r.$attrs,{class:"is-trigger button",onClick:o[1]||(o[1]=(...e)=>y(t)&&y(t)(...e))}),[e.title?(f(),b("span",L,_(e.title),1)):j("",!0),k("span",{class:[!e.modern&&"base-caret",e.modern&&"base-caret"]},[y(i)?(f(),b(n,{key:1,icon:"fa:angle-up"})):(f(),b(n,{key:0,icon:"fa:angle-down"}))],2)],16)]),!0),k("div",W,[k("div",X,[h(r.$slots,"content",{close:y(s)},(()=>[G]),!0)])])],2)}}});H.__scopeId="data-v-68ae80e6";const J={key:0,class:"builder-card"},K={class:"builder-head"},N={class:"pull-state-bar"},Q=S(" merged commit into "),Y=S(" from "),Z={class:"icon-timeline"},ee={class:"timeline-item"},ae=k("div",{class:"timeline-icon"},[k("i",{class:"iconify","data-icon":"feather:user"})],-1),le={class:"timeline-content"},se={class:"exerpt"},te={key:0,class:"timeline-item"},ie=k("div",{class:"timeline-icon"},[k("i",{class:"iconify","data-icon":"feather:user"})],-1),re={class:"timeline-content"},oe={class:"exerpt",style:{border:"0"}},ne={key:1,class:"timeline-item"},de=k("div",{class:"timeline-icon"},[k("i",{class:"iconify","data-icon":"feather:git-merge"})],-1),ce={class:"timeline-content"},ue={class:"exerpt",style:{border:"0"}},pe=S(" 到 "),me={key:2,class:"timeline-item"},ve=k("div",{class:"timeline-icon is-success"},[k("i",{class:"iconify","data-icon":"feather:git-pull-request"})],-1),ge={class:"timeline-content"},fe={class:"exerpt"},be=k("h4",null,"这个分支在 rebase 的时候和 base 分支没有冲突",-1),he={key:0},ye={key:1},ke={key:2,class:"form-inner"},_e={key:0,class:"field is-horizontal"},je={class:"field-body"},we={key:1,class:"field is-horizontal"},xe={class:"field-body"},Ce={class:"field is-horizontal"},qe={class:"field-body"},Oe=S("确认"),Me=S("取消"),Pe={key:3},Be=S("Create a merge commit"),Fe=S("Squash and merge"),Se=S("Rebase and merge"),Ve=k("div",{class:"icon"},[k("i",{class:"iconify","data-icon":"feather:git-merge"})],-1),ze=k("div",{class:"meta"},[k("span",null,"Merge"),k("span",null,"Create a merge commit")],-1),Re=k("div",{class:"icon"},[k("i",{class:"iconify","data-icon":"feather:git-pull-request"})],-1),De=k("div",{class:"meta"},[k("span",null,"Squash-merge"),k("span",null,"Squash and merge")],-1),Ae=k("div",{class:"icon"},[k("i",{class:"iconify","data-icon":"feather:git-branch"})],-1),Ee=k("div",{class:"meta"},[k("span",null,"Rebase-merge"),k("span",null,"Rebase and merge")],-1),Ie={key:3,class:"timeline-item"},Te=k("div",{class:"timeline-icon is-purple"},[k("i",{class:"iconify","data-icon":"feather:git-pull-request"})],-1),Ue=k("div",{class:"timeline-content"},[k("div",{class:"exerpt"},[k("h4",null,"请求已成功合并"),k("p",null,"你可以安全地删除分支")])],-1);var $e=g({expose:[],props:{pull:{type:Object,required:!1}},setup(e){const a=D();A();const l=E(),s=C("merge"),t=C(!1),r=q({id:a.params.projectid,index:a.params.number,MergeTitleField:"",MergeMessageField:""}),u=(e,a)=>{s.value=e,a()},p=()=>{t.value=!0},m=O((()=>l.state.user.commits));return M((()=>{l.dispatch("user/getPullCommits",{id:a.params.projectid,index:a.params.number,page:1,size:100}).then((()=>{console.log("commits",m)}))})),(v,g)=>{const h=o,w=d,x=n,C=c,q=d,O=H,M=n;return f(),b("div",null,[e.pull.user?(f(),b("div",J,[k("div",K,[k("h3",null,_(e.pull.title)+" #"+_(e.pull.number),1),k("div",N,[k(h,{color:e.pull.merged?"purple":"success",icon:"feather:git-pull-request",raised:"",rounded:""},{default:P((()=>[S(_(e.pull.merged?"Merged":e.pull.state),1)])),_:1},8,["color"]),k("b",null,_(e.pull.user.login),1),Q,k("em",null,_(e.pull.base.label),1),Y,k("em",null,_(e.pull.head.label),1)]),k("div",null,[k("div",Z,[k("div",ee,[ae,k("div",le,[k("div",se,_(e.pull.body),1)])]),y(m).data.length>0?(f(),b("div",te,[ie,k("div",re,[k("div",oe,[k("ul",null,[(f(!0),b(B,null,F(y(m).data,(e=>(f(),b("li",null,[S(_(e.commit.message)+" ",1),k("em",null,_(e.sha.substr(0,12)),1)])))),256))])])])])):j("",!0),e.pull.merged?(f(),b("div",ne,[de,k("div",ce,[k("div",ue,[k("b",null,_(e.pull.user.login),1),S(" 于 "+_(e.pull.merged_at)+" 合并了提交 ",1),k("em",null,_(e.pull.merge_commit_sha.substr(0,12)),1),pe,k("em",null,_(e.pull.base.label),1)])])])):j("",!0),e.pull.merged||"closed"===e.pull.state?j("",!0):(f(),b("div",me,[ve,k("div",ge,[k("div",fe,[be,0===y(m).data.length?(f(),b("p",he,"两个分支一样，无需进行合并")):(f(),b("p",ye,"可以自动执行变基和合并")),t.value?(f(),b("div",ke,["rebase"!==s.value?(f(),b("div",_e,[k("div",je,[k(x,null,{default:P((()=>[k(w,null,{default:P((()=>[V(k("input",{"onUpdate:modelValue":g[1]||(g[1]=e=>y(r).MergeTitleField=e),class:"input",type:"text",placeholder:"请输入标题"},null,512),[[z,y(r).MergeTitleField]])])),_:1})])),_:1})])])):j("",!0),"rebase"!==s.value?(f(),b("div",we,[k("div",xe,[k(x,null,{default:P((()=>[k(w,null,{default:P((()=>[V(k("textarea",{"onUpdate:modelValue":g[2]||(g[2]=e=>y(r).MergeMessageField=e),class:"textarea",rows:"3",placeholder:"请输入内容"},"\n                            ",512),[[z,y(r).MergeMessageField]])])),_:1})])),_:1})])])):j("",!0),k("div",Ce,[k("div",qe,[k(x,null,{default:P((()=>[k(w,null,{default:P((()=>[k(C,null,{default:P((()=>[k(h,{onClick:g[3]||(g[3]=e=>(t.value=!1,void l.dispatch("user/merge",i(i({},r),{Do:s.value})).then((()=>{l.dispatch("user/getPullRequest",{id:a.params.projectid,index:a.params.number})})))),color:"success"},{default:P((()=>[Oe])),_:1}),k(h,{onClick:g[4]||(g[4]=e=>t.value=!1)},{default:P((()=>[Me])),_:1})])),_:1})])),_:1})])),_:1})])])])):j("",!0),t.value?j("",!0):(f(),b("div",Pe,[k(M,{addons:""},{default:P((()=>[k(q,null,{default:P((()=>["merge"===s.value?(f(),b(h,{key:0,disabled:!e.pull.mergeable||0===y(m).data.length,onClick:g[5]||(g[5]=e=>p()),color:"success"},{default:P((()=>[Be])),_:1},8,["disabled"])):j("",!0),"squash"===s.value?(f(),b(h,{key:1,disabled:!e.pull.mergeable||0===y(m).data.length,onClick:g[6]||(g[6]=e=>p()),color:"success"},{default:P((()=>[Fe])),_:1},8,["disabled"])):j("",!0),"rebase"===s.value?(f(),b(h,{key:2,disabled:!e.pull.mergeable||0===y(m).data.length,onClick:g[7]||(g[7]=e=>p()),color:"success"},{default:P((()=>[Se])),_:1},8,["disabled"])):j("",!0)])),_:1}),k(q,null,{default:P((()=>[k(O,{dots:"",right:"",spaced:""},{button:P((({open:e})=>[k(h,{color:"success",icon:"fas fa-caret-down",onClick:e},null,8,["onClick"])])),content:P((({close:e})=>[k("a",{onClick:a=>u("merge",e),class:"dropdown-item is-media"},[Ve,ze],8,["onClick"]),k("a",{onClick:a=>u("squash",e),class:"dropdown-item is-media"},[Re,De],8,["onClick"]),k("a",{onClick:a=>u("rebase",e),class:"dropdown-item is-media"},[Ae,Ee],8,["onClick"])])),_:1})])),_:1})])),_:1})]))])])])),e.pull.merged?(f(),b("div",Ie,[Te,Ue])):j("",!0)])])])])):j("",!0)])}}});const Le={class:"page-title has-text-centered"},We={class:"menu-toggle has-chevron"},Xe=k("span",{class:"rotate"},[k("i",{class:"icon-line-top"}),k("i",{class:"icon-line-center"}),k("i",{class:"icon-line-bottom"})],-1),Ge={class:"title-wrap"},He={key:0,class:"title is-4"},Je={class:"page-content-inner"},Ke={class:"breadcrumb-box"},Ne=k("i",{class:"iconify","data-icon":"feather:corner-down-left"},null,-1);var Qe=g({expose:[],setup(e){const a=D(),l=A(),s=E(),t=C(!0);I({title:"合并请求"}),M((()=>{U.value="projects"}));const i=O((()=>s.state.user.project)),o=O((()=>s.state.user.pull)),n=C();return R((()=>{console.log("route.params",a.params),Promise.all([s.dispatch("user/getProject",a.params.projectid),s.dispatch("user/getPullRequest",{id:a.params.projectid,index:a.params.number})]).then((()=>{n.value=[{icon:"feather:home",hideLabel:!0,to:{name:"user-projects"}},{label:"Pull Request",to:{name:"user-projects"}},{label:i.value.repo_name,to:{name:"user-projects-projectid-files",params:{projectid:a.params.projectid}}}],t.value=!1}))})),(e,a)=>{const s=r,i=$e,d=T;return f(),b("div",null,[k("div",Le,[k("div",{class:"vuero-hamburger nav-trigger push-resize",onClick:a[1]||(a[1]=e=>y($)("projects"))},[k("span",We,[k("span",{class:[["projects"===y(U)&&"active"],"icon-box-toggle"]},[Xe],2)])]),k("div",Ge,[y(o)?(f(),b("h1",He,_(y(o).title),1)):j("",!0)])]),k("div",Je,[k(d,{size:"large",active:t.value},{default:P((()=>[k("div",Ke,[n.value?(f(),b(s,{key:0,items:n.value,separator:"bullet","with-icons":""},null,8,["items"])):j("",!0),k("div",{class:"back-button",onClick:a[2]||(a[2]=()=>y(l).back())},[Ne])]),k(i,{pull:y(o)},null,8,["pull"])])),_:1},8,["active"])])])}}});export default Qe;
