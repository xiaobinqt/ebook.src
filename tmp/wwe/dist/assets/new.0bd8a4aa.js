var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable,t=(a,l,s)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[l]=s,r=(e,r)=>{for(var i in r||(r={}))a.call(r,i)&&t(e,i,r[i]);if(l)for(var i of l(r))s.call(r,i)&&t(e,i,r[i]);return e};import{_ as i}from"./V-Breadcrumb.vue_vue&type=script&setup=true&lang.95222eda.js";import{_ as o,a as u}from"./V-Field.vue_vue&type=script&setup=true&lang.50df6a27.js";import{_ as d}from"./V-Button.vue_vue&type=script&setup=true&lang.7d7c3fd2.js";import{_ as c}from"./V-Loader.vue_vue&type=script&setup=true&lang.152a1df5.js";import{_ as n}from"./V-Buttons.vue_vue&type=script&setup=true&lang.88c78073.js";import{_ as p}from"./V-Message.vue_vue&type=script&setup=true&lang.177426e4.js";import{d as f,r as v,b,W as m,j as h,k as _,n as y,m as g,P as j,X as x,u as k,Z as V,F as w,S as O,U as z,E as q,A as P,O as B}from"./vendor.6243191d.js";import{a as S,c as U,d as C,u as M}from"./index.670b29b2.js";import{u as E}from"./useNotyf.8c9a8697.js";import{a as F,t as L}from"./activeSidebarState.4b53b430.js";const R={class:"form-card",style:{width:"auto",height:"auto"}},A={class:"form-inner"},D={class:"field is-horizontal"},I=y("div",{class:"field-label is-normal"},[y("label",{class:"label required"},"标题")],-1),N={class:"field-body"},W={class:"field is-horizontal"},X=y("div",{class:"field-label is-normal"},[y("label",{class:"label required"},"分支")],-1),Z={class:"field-body"},G=y("a",{class:"button is-static"},[y("i",{class:"iconify","data-icon":"feather:git-pull-request"})],-1),H={class:"select"},J=y("i",{class:"iconify","data-icon":"feather:arrow-left"},null,-1),K=y("a",{class:"button is-static"},[y("i",{class:"iconify","data-icon":"feather:git-merge"})],-1),Q={class:"select"},T={class:"field is-horizontal"},Y=y("div",{class:"field-label is-normal"},[y("label",{class:"label"},"内容")],-1),$={class:"field-body"},ee={class:"field is-horizontal"},ae=y("div",{class:"field-label is-normal"},[y("label",{class:"label"})],-1),le={class:"field-body"},se={class:"field is-horizontal"},te=y("div",{class:"field-label is-normal"},null,-1),re={class:"field-body"};var ie=f({expose:[],props:{pull:{type:Object,required:!1}},setup(e){const{pull:a}=e,l=S(),s=U(),t=C(),i=E(),f=v(!1),B=v([]),M=b({id:l.params.projectid,head:"master",base:"master",title:"",body:""});a&&(M.repo_name=project.repo_name,M.desc=project.desc,M.level=project.level,M.data_set=project.data_set);return m((()=>{t.dispatch("user/getBranches",{id:l.params.projectid,simple:!1}).then((e=>{B.value=t.getters["user/getSimpleBranches"]}))})),(e,v)=>{const b=u,m=o,S=u,U=o,C=d,E=c,F=n,L=p;return h(),_("div",R,[y("div",A,[y("div",D,[I,y("div",N,[y(m,null,{default:g((()=>[y(b,null,{default:g((()=>[j(y("input",{"onUpdate:modelValue":v[1]||(v[1]=e=>k(M).title=e),class:"input",type:"text",placeholder:"请输入标题"},null,512),[[x,k(M).title]])])),_:1})])),_:1})])]),y("div",W,[X,y("div",Z,[y(m,{grouped:""},{default:g((()=>[y(b,null,{default:g((()=>[y(U,{addons:""},{default:g((()=>[y(S,null,{default:g((()=>[G])),_:1}),y(S,{expanded:""},{default:g((()=>[y("div",H,[j(y("select",{"onUpdate:modelValue":v[2]||(v[2]=e=>k(M).base=e)},[(h(!0),_(w,null,O(B.value,((e,a)=>(h(),_("option",{key:"i",value:e.value},z(e.label),9,["value"])))),128))],512),[[V,k(M).base]])])])),_:1})])),_:1})])),_:1}),y(b,{style:{"line-height":"38px"}},{default:g((()=>[J])),_:1}),y(b,null,{default:g((()=>[y(U,{addons:""},{default:g((()=>[y(S,null,{default:g((()=>[K])),_:1}),y(S,{expanded:""},{default:g((()=>[y("div",Q,[j(y("select",{"onUpdate:modelValue":v[3]||(v[3]=e=>k(M).head=e)},[(h(!0),_(w,null,O(B.value,((e,a)=>(h(),_("option",{key:"i",value:e.value},z(e.label),9,["value"])))),128))],512),[[V,k(M).head]])])])),_:1})])),_:1})])),_:1})])),_:1})])]),y("div",T,[Y,y("div",$,[y(m,null,{default:g((()=>[y(b,null,{default:g((()=>[j(y("textarea",{"onUpdate:modelValue":v[4]||(v[4]=e=>k(M).body=e),class:"textarea",rows:"6",placeholder:"请输入内容"},"\n              ",512),[[x,k(M).body]])])),_:1})])),_:1})])]),y("div",ee,[ae,y("div",le,[y(m,null,{default:g((()=>[y(b,null,{default:g((()=>[y(F,null,{default:g((()=>[y(E,{size:"small",active:f.value},{default:g((()=>[y(C,{disabled:f.value,onClick:v[5]||(v[5]=e=>(()=>{if(f.value)return!1;f.value=!0,a?t.dispatch("user/updatePullRequest",r(r({},M),{index:a.number})).then((()=>{i.success("修改成功！"),s.push({name:"user-projects"})})):t.dispatch("user/createPullRequest",M).then((e=>{i.success("创建成功！"),s.push({name:"user-projects-projectid-pulls-number",params:{projectid:l.params.projectid,number:e.number}})})).catch((e=>{f.value=!1,console.log("error",e),i.error(e.data||e)})),console.log("formData",M)})()),color:"primary",raised:""},{default:g((()=>[q(z((e.project,"确定")),1)])),_:1},8,["disabled"])])),_:1},8,["active"])])),_:1})])),_:1})])),_:1})])]),y("div",se,[te,y("div",re,[y(m,null,{default:g((()=>[y(b,null,{default:g((()=>[e.errorMessage?(h(),_(L,{key:0,color:"danger"},{default:g((()=>[q(z(e.errorMessage),1)])),_:1})):P("",!0)])),_:1})])),_:1})])])])])}}});const oe={class:"page-title has-text-centered"},ue={class:"menu-toggle has-chevron"},de=y("span",{class:"rotate"},[y("i",{class:"icon-line-top"}),y("i",{class:"icon-line-center"}),y("i",{class:"icon-line-bottom"})],-1),ce=y("div",{class:"title-wrap"},[y("h1",{class:"title is-4"},"新建合并请求")],-1),ne={class:"page-content-inner"},pe={class:"breadcrumb-box"},fe=y("i",{class:"iconify","data-icon":"feather:corner-down-left"},null,-1);var ve=f({expose:[],setup(e){S();const a=U();C(),M({title:"新建合并请求"}),B((()=>{F.value="none"}));const l=[{icon:"feather:home",hideLabel:!0,to:{name:"user-projects"}},{label:"项目",to:{name:"user-projects"}},{label:"新建合并请求"}];return m((()=>{})),(e,s)=>{const t=i,r=ie;return h(),_("div",null,[y("div",oe,[y("div",{class:"vuero-hamburger nav-trigger push-resize",onClick:s[1]||(s[1]=e=>k(L)("none"))},[y("span",ue,[y("span",{class:[["none"===k(F)&&"active"],"icon-box-toggle"]},[de],2)])]),ce]),y("div",ne,[y("div",pe,[l?(h(),_(t,{key:0,items:l,separator:"bullet","with-icons":""})):P("",!0),y("div",{class:"back-button",onClick:s[2]||(s[2]=()=>k(a).back())},[fe])]),y(r)])])}}});export default ve;
