var e=Object.defineProperty,l=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,s=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,n=(e,n)=>{for(var o in n||(n={}))l.call(n,o)&&s(e,o,n[o]);if(a)for(var o of a(n))t.call(n,o)&&s(e,o,n[o]);return e};import{_ as o,a as u}from"./V-Field.vue_vue&type=script&setup=true&lang.50df6a27.js";import{_ as c}from"./V-Message.vue_vue&type=script&setup=true&lang.177426e4.js";import{d as i,v as p,r as d,b as r,a as m,j as f,k as y,n as v,P as h,X as b,u as g,a3 as _,i as V,m as C,A as k,F as x,S as N,z as j,Z as U,E as w,a4 as O,W as P,U as S}from"./vendor.6243191d.js";import{a as A,c as M,d as q}from"./index.670b29b2.js";import{u as z}from"./useNotyf.8c9a8697.js";import{_ as E}from"./V-Button.vue_vue&type=script&setup=true&lang.7d7c3fd2.js";import{_ as F}from"./V-Buttons.vue_vue&type=script&setup=true&lang.88c78073.js";const $={class:"fieldset-args"},B={class:"columns is-multiline"},J={class:"column is-4"},T={class:"column is-4"},D={class:"column is-3"},I={class:"column is-1"},W=v("i",{class:"fas fa-minus-circle"},null,-1);var X=i({expose:[],props:{field:{type:Object,required:!1},index:{type:Number,required:!1},type:{type:String,required:!1}},setup(e){const{field:l,index:a,type:t}=e,s=A();M();const o=q();p((()=>s.query.project||"")),p((()=>o.state.channel.user)),p((()=>o.state.user.instances)),d([]);const u=V("updateField"),c=V("removeField");console.log("field",l);const i=r(n(n({},l),{color:l.color?l.color:["#f2711c","#2185d0","#21ba45","#b5cc18","#00b5ad","#fbbd08","#6435c9","#a333c8","#e03997","#a5673f"][a]||`#${Math.floor(16777215*Math.random()).toString(16).padEnd(6,"0")}`}));return d(""),m(i,((e,l)=>{console.log("newData",e),u(e,!0,a)})),(e,l)=>(f(),y("div",$,[v("div",B,[v("div",J,[h(v("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>g(i).key=e),type:"text",class:"input",placeholder:"例如：PhV_phsA",autocomplete:"given-name"},null,512),[[b,g(i).key]])]),v("div",T,[h(v("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>g(i).name=e),type:"text",class:"input",placeholder:"例如：A相电压",autocomplete:"given-name"},null,512),[[b,g(i).name]])]),v("div",D,[h(v("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>g(i).color=e),type:"color",class:"input",placeholder:"例如：#e62864",autocomplete:"given-name"},null,512),[[_,"switch"!==t],[b,g(i).color]])]),v("div",I,[v("div",{class:"minus-field",onClick:l[4]||(l[4]=e=>g(c)(a))},[W])])])]))}});const Z={class:"fieldset-args"},G={class:"columns is-multiline"},H={class:"column is-12"},K=v("label",null,"组名称",-1),L={class:"column is-6"},Q=v("label",null,"图表类型",-1),R={class:"select"},Y=v("option",{value:""},"请选择",-1),ee=v("option",{value:"line"},"折线图",-1),le=v("option",{value:"accumulation-line"},"累加折线图",-1),ae=v("option",{value:"aggregation-line"},"聚合折线图",-1),te=v("option",{value:"gauge"},"仪表盘",-1),se=v("option",{value:"switch"},"开关状态图",-1),ne={class:"column is-6"},oe=v("label",null,"单位",-1),ue={key:0,class:"column is-3"},ce=v("label",null,"显示范围",-1),ie={key:1,class:"column is-3"},pe=v("label",null," ",-1),de={key:2,class:"column is-3"},re=v("label",null," ",-1),me={key:3,class:"column is-3"},fe=v("label",null," ",-1),ye={key:4,class:"column is-3"},ve=v("label",null,"区域颜色",-1),he={key:5,class:"column is-3"},be=v("label",null," ",-1),ge={key:6,class:"column is-3"},_e=v("label",null," ",-1),Ve={key:7,class:"column is-6"},Ce=v("label",null,"聚合间隔（秒）",-1),ke={class:"column is-12"},xe={class:"button-box"},Ne=w("删除"),je=w("添加字段");var Ue=i({expose:[],props:{chart:{type:Object,required:!1},index:{type:Number,required:!1}},setup(e){const{chart:l,index:a}=e,t=A();M();const s=q();p((()=>t.query.project||"")),p((()=>s.state.channel.user)),p((()=>s.state.user.instances)),d([]),console.log("prop chart",l);const n=l,c=V("updateCharts"),i=V("removeCharts");j("updateField",((e,l,a)=>{if(l){const l=[...n.legends];l.splice(a,1,e),n.legends=l}})),j("removeField",(e=>{const l=n.legends;l.splice(e,1),n.legends=l})),m(n,((e,l)=>{c(n,!0,a)}));return(e,t)=>{const s=u,c=o,p=X,d=E;return f(),y("div",Z,[v("div",G,[v("div",H,[v(c,null,{default:C((()=>[K,v(s,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>g(n).name=e),type:"text",class:"input",placeholder:"例如：三相电压",autocomplete:"given-name"},null,512),[[b,g(n).name]])])),_:1})])),_:1})]),v("div",L,[v(c,null,{default:C((()=>[Q,v(s,null,{default:C((()=>[v("div",R,[h(v("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>g(n).type=e)},[Y,ee,le,ae,te,se],512),[[U,g(n).type]])])])),_:1})])),_:1})]),v("div",ne,[v(c,null,{default:C((()=>[oe,v(s,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>g(n).unit=e),type:"text",class:"input",placeholder:"例如：V",autocomplete:"family-name"},null,512),[[b,g(n).unit]])])),_:1})])),_:1})]),"gauge"===g(n).type?(f(),y("div",ue,[v(c,null,{default:C((()=>[ce,v(s,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>g(n).spaceNumber0=e),type:"number",class:"input",placeholder:"",autocomplete:"family-name"},null,512),[[b,g(n).spaceNumber0]])])),_:1})])),_:1})])):k("",!0),"gauge"===g(n).type?(f(),y("div",ie,[v(c,null,{default:C((()=>[pe,v(s,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>g(n).spaceNumber1=e),type:"number",class:"input",placeholder:"",autocomplete:"family-name"},null,512),[[b,g(n).spaceNumber1]])])),_:1})])),_:1})])):k("",!0),"gauge"===g(n).type?(f(),y("div",de,[v(c,null,{default:C((()=>[re,v(s,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>g(n).spaceNumber2=e),type:"number",class:"input",placeholder:"",autocomplete:"family-name"},null,512),[[b,g(n).spaceNumber2]])])),_:1})])),_:1})])):k("",!0),"gauge"===g(n).type?(f(),y("div",me,[v(c,null,{default:C((()=>[fe,v(s,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>g(n).spaceNumber3=e),type:"number",class:"input",placeholder:"",autocomplete:"family-name"},null,512),[[b,g(n).spaceNumber3]])])),_:1})])),_:1})])):k("",!0),"gauge"===g(n).type?(f(),y("div",ye,[v(c,null,{default:C((()=>[ve,v(s,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>g(n).scopeColor0=e),type:"color",class:"input",placeholder:"例如：#e62864",autocomplete:"given-name"},null,512),[[_,"switch"!==e.type],[b,g(n).scopeColor0]])])),_:1})])),_:1})])):k("",!0),"gauge"===g(n).type?(f(),y("div",he,[v(c,null,{default:C((()=>[be,v(s,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>g(n).scopeColor1=e),type:"color",class:"input",placeholder:"例如：#e62864",autocomplete:"given-name"},null,512),[[_,"switch"!==e.type],[b,g(n).scopeColor1]])])),_:1})])),_:1})])):k("",!0),"gauge"===g(n).type?(f(),y("div",ge,[v(c,null,{default:C((()=>[_e,v(s,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>g(n).scopeColor2=e),type:"color",class:"input",placeholder:"例如：#e62864",autocomplete:"given-name"},null,512),[[_,"switch"!==e.type],[b,g(n).scopeColor2]])])),_:1})])),_:1})])):k("",!0),"aggregation-line"===g(n).type||"accumulation-line"===g(n).type?(f(),y("div",Ve,[v(c,null,{default:C((()=>[Ce,v(s,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>g(n).space=e),min:"1",type:"number",class:"input",placeholder:"例如：300",autocomplete:"family-name"},null,512),[[b,g(n).space]])])),_:1})])),_:1})])):k("",!0),v("div",ke,[(f(!0),y(x,null,N(l.legends,((e,a)=>(f(),y(p,{type:g(n).type,index:a,key:l.name,field:e},null,8,["type","index","field"])))),128))])]),v("div",xe,[v(d,{color:"danger",icon:"feather:minus-circle",bold:"",onClick:t[12]||(t[12]=e=>g(i)(a))},{default:C((()=>[Ne])),_:1}),v(d,{color:"info",icon:"feather:plus-circle",bold:"",onClick:t[13]||(t[13]=e=>(()=>{console.log("formData",n);const e=[...n.legends,{key:"",name:"",color:""}];console.log("legends",e),n.legends=e})())},{default:C((()=>[je])),_:1})])])}}});const we=w("新增一组数据");var Oe=i({expose:[],props:{typecharts:{type:Array}},setup(e){const{typecharts:l}=e;A(),M(),q(),console.log("typecharts",l);const a=d(l);j("updateCharts",((e,l,t)=>{l&&(a.value.splice(t,1,e),a.value=[...a.value])})),j("removeCharts",(e=>{console.log("index, charts.value",e,a.value),a.value.splice(e,1),a.value=[...a.value]}));const t=V("updateTypeCharts");return m(a,(e=>{console.log("charts",a),t(e)})),(e,l)=>{const t=Ue,s=E;return f(),y("div",null,[v("div",null,[(f(!0),y(x,null,N(a.value,((e,l)=>(f(),y(t,{index:l,key:`${a.value.length}-${l}`,chart:e},null,8,["index","chart"])))),128))]),v("div",null,[v(s,{color:"info",outlined:"",icon:"feather:plus-circle",fullwidth:"",onClick:l[1]||(l[1]=e=>{a.value=[...a.value,{name:"三相电压",type:"line",unit:"V",space:"300",spaceNumber0:"0",spaceNumber1:"60",spaceNumber2:"80",spaceNumber3:"100",scopeColor0:"#41b983",scopeColor1:"#faad42",scopeColor2:"#e62864",legends:[{key:"PhV_phsA",name:"A相电压",color:`#${Math.floor(16777215*Math.random()).toString(16).padEnd(6,"0")}`},{key:"PhV_phsB",name:"B相电压",color:`#${Math.floor(16777215*Math.random()).toString(16).padEnd(6,"0")}`},{key:"PhV_phsC",name:"C相电压",color:`#${Math.floor(16777215*Math.random()).toString(16).padEnd(6,"0")}`}]}]})},{default:C((()=>[we])),_:1})])])}}});const Pe={class:"form-card",style:{width:"auto",height:"auto"}},Se={class:"form-inner"},Ae={class:"field is-horizontal"},Me=v("div",{class:"field-label is-normal"},[v("label",{class:"label"},"数据图表名称")],-1),qe={class:"field-body"},ze={class:"field is-horizontal"},Ee=v("div",{class:"field-label is-normal"},[v("label",{class:"label"},"数据分组")],-1),Fe={class:"field-body"},$e=w("一组数据是单位和概念相同的多个字段，比如三相电压：PhV_phsA、PhV_phsB、PhV_phsC"),Be={class:"field is-horizontal"},Je=v("div",{class:"field-label is-normal"},[v("label",{class:"label"},"图表描述")],-1),Te={class:"field-body"},De={class:"field is-horizontal"},Ie=v("div",{class:"field-label is-normal"},[v("label",{class:"label"})],-1),We={class:"field-body"},Xe=w("提交"),Ze={class:"field is-horizontal"},Ge=v("div",{class:"field-label is-normal"},null,-1),He={class:"field-body"};var Ke=i({expose:[],props:{type:{type:Object,required:!1}},setup(e){const{type:l}=e;A();const a=M(),t=q(),s=z(),i=d(""),p=r({name:"交采数据",charts:[],desc:""});l&&l.type_id&&(p.name=l.name,p.charts=JSON.parse(JSON.stringify(O(l.charts))),p.desc=l.desc);j("updateTypeCharts",(e=>{console.log("newCharts",e),p.charts=e}));return P((()=>{})),(e,d)=>{const r=u,m=o,_=c,V=Oe,x=E,N=F,j=c;return f(),y("div",Pe,[v("div",Se,[v("div",Ae,[Me,v("div",qe,[v(m,null,{default:C((()=>[v(r,null,{default:C((()=>[h(v("input",{"onUpdate:modelValue":d[1]||(d[1]=e=>g(p).name=e),class:"input",type:"text",placeholder:"类型名称"},null,512),[[b,g(p).name]])])),_:1})])),_:1})])]),v("div",ze,[Ee,v("div",Fe,[v(m,null,{default:C((()=>[v(r,null,{default:C((()=>[v(_,{color:"info"},{default:C((()=>[$e])),_:1}),v(V,{typecharts:g(p).charts},null,8,["typecharts"])])),_:1})])),_:1})])]),v("div",Be,[Je,v("div",Te,[v(m,null,{default:C((()=>[v(r,null,{default:C((()=>[h(v("textarea",{"onUpdate:modelValue":d[2]||(d[2]=e=>g(p).desc=e),class:"textarea",rows:"6",placeholder:"数据图表描述"},"\n              ",512),[[b,g(p).desc]])])),_:1})])),_:1})])]),v("div",De,[Ie,v("div",We,[v(m,null,{default:C((()=>[v(r,null,{default:C((()=>[v(N,null,{default:C((()=>[v(x,{onClick:d[3]||(d[3]=e=>(l&&l.type_id?t.dispatch("channel/updateAppType",n(n({},p),{id:l.type_id})).then((()=>{s.success("修改成功！"),a.push({name:"admin-types"})})).catch((e=>{i.value=e.message||e})):t.dispatch("channel/createAppType",p).then((()=>{s.success("添加成功！"),a.push({name:"admin-types"})})).catch((e=>{i.value=e.message||e})),void console.log("formData",JSON.parse(JSON.stringify(p))))),color:"primary",raised:""},{default:C((()=>[Xe])),_:1})])),_:1})])),_:1})])),_:1})])]),v("div",Ze,[Ge,v("div",He,[v(m,null,{default:C((()=>[v(r,null,{default:C((()=>[i.value?(f(),y(j,{key:0,color:"danger"},{default:C((()=>[w(S(i.value),1)])),_:1})):k("",!0)])),_:1})])),_:1})])])])])}}});export{Ke as _};
