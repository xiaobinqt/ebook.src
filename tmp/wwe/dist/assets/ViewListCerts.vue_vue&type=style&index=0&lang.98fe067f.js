import{_ as e,a}from"./V-Field.vue_vue&type=script&setup=true&lang.50df6a27.js";import{_ as l}from"./V-Button.vue_vue&type=script&setup=true&lang.7d7c3fd2.js";import{_ as t}from"./V-FlexTableRowCerts.vue_vue&type=script&setup=true&lang.9e8e7128.js";import{_ as s}from"./V-FlexTable.vue_vue&type=script&setup=true&lang.19fc13e5.js";import{_ as i}from"./V-FlexPagination.vue_vue&type=script&setup=true&lang.036e60ba.js";import{_ as n}from"./V-Tag.vue_vue&type=script&setup=true&lang.bf8fa42e.js";import{_ as c}from"./V-Modal.vue_vue&type=script&setup=true&lang.13c249d1.js";import{d as o,r,v as u,b as d,a as p,W as v,u as f,j as _,k as b,n as y,m,A as h,z as g,P as w,X as k,U as x,E as j}from"./vendor.6243191d.js";import{a as C,c as V,d as z}from"./index.670b29b2.js";import{u as A}from"./useNotyf.8c9a8697.js";const U={key:0},F={class:"list-view-toolbar"},T={class:"buttons"},B={class:"page-content-inner"},N=y("div",{class:"flex-table-header"},[y("span",null,"适配系统名称"),y("span",null,"产品版本"),y("span",null,"互认证状态"),y("span",null,"申请时间"),y("span",{class:"cell-end"},"操作")],-1),P={key:0,class:"info-table"},q={class:"info-table-row"},D=y("div",{class:"info-table-label"},"状态",-1),E={class:"info-table-content"},I={class:"info-table-row"},M=y("div",{class:"info-table-label"},"产品名称",-1),R={class:"info-table-content"},S={class:"info-table-row"},W=y("div",{class:"info-table-label"},"版本",-1),X={class:"info-table-content"},G={class:"info-table-row"},H=y("div",{class:"info-table-label"},"产品描述",-1),J={class:"info-table-content"},K={class:"info-table-row"},L=y("div",{class:"info-table-label"},"适配产品",-1),O={class:"info-table-content"},Q={class:"info-table-row"},Y=y("div",{class:"info-table-label"},"适配描述",-1),Z={class:"info-table-content"},$={key:0,class:"field is-horizontal"},ee=y("div",{class:"field-label is-normal"},[y("label",{class:"label"},"标题")],-1),ae={class:"field-body"},le={key:1,class:"field is-horizontal"},te=y("div",{class:"field-label is-normal"},[y("label",{class:"label"},"内容")],-1),se={class:"field-body"},ie={key:2,class:"field is-horizontal"},ne=y("div",{class:"field-label is-normal"},[y("label",{class:"label"},"拒绝理由")],-1),ce={class:"field-body"},oe=j("通过"),re=j("预览"),ue=j("拒绝");var de=o({expose:[],props:{audit:{type:Boolean,default:!1}},setup(o){const{audit:j}=o,de=C();V();const pe=z(),ve=A(),fe=r(!1),_e=r(!1),be=r(),ye=r(),me=r(""),he=u((()=>{try{return Number.parseInt(de.query.page)||1}catch(e){}return 1})),ge=u((()=>pe.state.channel.certs));g("viewCert",(e=>{fe.value=!0,be.value=e})),g("auditCert",((e,a)=>{_e.value=!0,ye.value=a,be.value=e})),g("isDownload",!1);const we=d({certificate_title:"",certificate_content:""}),ke=r("");p([me,he],((e,a)=>{e[0]===a[0]&&e[1]===a[1]||pe.dispatch("channel/getApplyCerts",{page:he.value,size:10,search:e[0],status:j?"1":void 0})}));const xe=function(){console.log("cert.value.user_id",be.value.user_id),"pass"===ye.value?pe.dispatch("channel/auditApplyCert",{apply_cert_id:be.value.apply_cert_id,certificate_title:we.certificate_title,certificate_content:we.certificate_content,state:"pass"}).then((()=>{_e.value=!1,ve.success("审核通过！")})):pe.dispatch("channel/auditApplyCert",{apply_cert_id:be.value.apply_cert_id,reject_reason:ke.value,state:"reject"}).then((()=>{_e.value=!1,ve.success("拒绝成功！")}))};return v((()=>{pe.dispatch("channel/getApplyCerts",{page:1,size:10,status:j?"1":void 0})})),(o,r)=>{const u=a,d=e,p=l,v=t,g=s,j=i,C=n,V=c;return f(ge).page_info?(_(),b("div",U,[y("div",F,[y(d,null,{default:m((()=>[y(u,{icon:"feather:search"},{default:m((()=>[w(y("input",{"onUpdate:modelValue":r[1]||(r[1]=e=>me.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,me.value]])])),_:1})])),_:1}),h("",!0),y("div",T,[h("",!0)])]),y("div",B,[y(g,{compact:""},{header:m((()=>[N])),body:m((()=>[y(v,{rows:f(ge).data},null,8,["rows"])])),_:1}),y(j,{"item-per-page":f(ge).page_info.size,"total-items":f(ge).page_info.count,"current-page":f(he),"max-links-displayed":5},null,8,["item-per-page","total-items","current-page"])]),y(V,{open:fe.value,size:"large",actions:"center",title:"审核证书",onClose:r[2]||(r[2]=e=>fe.value=!1)},{content:m((()=>[be.value?(_(),b("div",P,[y("div",q,[D,y("div",E,[2===be.value.status?(_(),b(C,{key:0,color:"success",label:be.value.ex_status_str,rounded:""},null,8,["label"])):h("",!0),3===be.value.status?(_(),b(C,{key:1,color:"danger",label:be.value.ex_status_str,rounded:""},null,8,["label"])):h("",!0),1===be.value.status?(_(),b(C,{key:2,label:be.value.ex_status_str,rounded:""},null,8,["label"])):h("",!0)])]),y("div",I,[M,y("div",R,x(be.value.product_name),1)]),y("div",S,[W,y("div",X,x(be.value.product_version),1)]),y("div",G,[H,y("div",J,x(be.value.product_desc),1)]),y("div",K,[L,y("div",O,x(be.value.channel_product),1)]),y("div",Q,[Y,y("div",Z,x(be.value.match_desc),1)])])):h("",!0)])),_:1},8,["open"]),y(V,{open:_e.value,size:"large",actions:"center",title:"审核证书",onClose:r[9]||(r[9]=e=>_e.value=!1)},{content:m((()=>[y("div",null,["pass"===ye.value?(_(),b("div",$,[ee,y("div",ae,[y(d,null,{default:m((()=>[y(u,null,{default:m((()=>[w(y("input",{"onUpdate:modelValue":r[3]||(r[3]=e=>f(we).certificate_title=e),class:"input",type:"text",placeholder:"标题"},null,512),[[k,f(we).certificate_title]])])),_:1})])),_:1})])])):h("",!0),"pass"===ye.value?(_(),b("div",le,[te,y("div",se,[y(d,null,{default:m((()=>[y(u,null,{default:m((()=>[w(y("textarea",{"onUpdate:modelValue":r[4]||(r[4]=e=>f(we).certificate_content=e),class:"textarea",rows:"6",placeholder:"内容"},"\n                  ",512),[[k,f(we).certificate_content]])])),_:1})])),_:1})])])):h("",!0),"reject"===ye.value?(_(),b("div",ie,[ne,y("div",ce,[y(d,null,{default:m((()=>[y(u,null,{default:m((()=>[w(y("textarea",{"onUpdate:modelValue":r[5]||(r[5]=e=>ke.value=e),class:"textarea",rows:"6",placeholder:"拒绝理由"},"\n                ",512),[[k,ke.value]])])),_:1})])),_:1})])])):h("",!0)])])),action:m((()=>["pass"===ye.value?(_(),b(p,{key:0,color:"primary",onClick:r[6]||(r[6]=e=>xe()),raised:""},{default:m((()=>[oe])),_:1})):h("",!0),"pass"===ye.value?(_(),b(p,{key:1,color:"info",onClick:r[7]||(r[7]=e=>{pe.dispatch("channel/previewApplyCert",{apply_cert_id:be.value.apply_cert_id,certificate_title:we.certificate_title,certificate_content:we.certificate_content}).then((()=>{window.open("/api/channel/applyCert/preview?apply_cert_id="+be.value.apply_cert_id,"_blank")}))}),raised:""},{default:m((()=>[re])),_:1})):h("",!0),"reject"===ye.value?(_(),b(p,{key:2,color:"danger",onClick:r[8]||(r[8]=e=>xe()),raised:""},{default:m((()=>[ue])),_:1})):h("",!0)])),_:1},8,["open"])])):h("",!0)}}});export{de as _};
