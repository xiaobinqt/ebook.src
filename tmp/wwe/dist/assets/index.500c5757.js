import{_ as e}from"./V-Breadcrumb.vue_vue&type=script&setup=true&lang.95222eda.js";import{_ as s}from"./Eventsource.vue_vue&type=script&setup=true&lang.2ffe835f.js";import{a,_ as t}from"./V-Field.vue_vue&type=script&setup=true&lang.50df6a27.js";import{_ as n}from"./V-FlexNone.vue_vue&type=script&setup=true&lang.cbed393c.js";import{_ as r}from"./V-FlexTableRowDeploys.d057f8cd.js";import{_ as l}from"./V-FlexTable.vue_vue&type=script&setup=true&lang.19fc13e5.js";import{_ as o}from"./V-FlexPagination.vue_vue&type=script&setup=true&lang.036e60ba.js";import{_ as c}from"./V-PlaceholderSection.vue_vue&type=script&setup=true&lang.67c36c04.js";import{_ as i}from"./V-Button.vue_vue&type=script&setup=true&lang.7d7c3fd2.js";import{_ as p}from"./V-Modal.vue_vue&type=script&setup=true&lang.13c249d1.js";import{B as u,C as d,d as m,r as v,v as g,a as f,W as h,j as _,k as b,n as y,P as j,X as x,u as w,A as V,$ as k,E as z,z as I,O as $}from"./vendor.6243191d.js";import{a as C,c as F,d as S,u as A}from"./index.670b29b2.js";import{u as B}from"./useNotyf.8c9a8697.js";import{a as N,t as P}from"./activeSidebarState.4b53b430.js";import"./V-Tag.vue_vue&type=script&setup=true&lang.bf8fa42e.js";import"./useDropdown.490deeca.js";import"./index.1b405f09.js";const T=k();u("data-v-055d2c94");const D={class:"page-content-inner"},E={class:"list-view-toolbar"},q=y("div",{class:"buttons"},null,-1),L=y("div",{class:"flex-table-header"},[y("span",null,"名称"),y("span",{class:"flex-grow-short"},"部署状态"),y("span",{class:"flex-grow-short"},"运行状态"),y("span",{class:"flex-grow-short"},"端设备模型"),y("span",{class:"flex-grow-short"},"终端状态"),y("span",null,"所属终端"),y("span",null,"所属人"),y("span",{class:"time"},"时间"),y("span",{class:"cell-end"},"操作")],-1),M=z("确认");d();var O=m({expose:[],setup(e){const u=B(),d=C(),m=F(),k=S();v(!1),v();const z=v(""),$=v(!1),A=g((()=>{try{return Number.parseInt(d.query.page)||1}catch(e){}return 1})),N=g((()=>k.state.channel.instances)),P=v(null),O={deploy_app:"部署",start_app:"启动",stop_app:"停止"},R=e=>{"successed"===e.status&&u.success(`实例 ${e.instance_name} ${O[e.topic]}成功！`),"failed"===e.status&&u.error(`实例 ${e.instance_name} ${O[e.topic]}失败，${e.message}`),k.dispatch("channel/getInstances",{page:A.value,size:10})};f([z,A],((e,s)=>{e[0]!==s[0]&&(m.push("instances"),k.dispatch("channel/getInstances",{page:1,size:10,search:e[0]})),e[1]!==s[1]&&k.dispatch("channel/getInstances",{page:A.value,size:10,search:e[0]})}));const U=e=>{console.log("row.instance_id",P),k.dispatch("user/removeApp",P.value.instance_id).then((()=>{u.success("删除成功！"),$.value=!1,k.dispatch("channel/getInstances",{id:d.params.projectid,page:A.value,size:10})})).catch((e=>{u.error(e.message),$.value=!1}))};return I("removeApp",(e=>{$.value=!0,P.value=e})),h((()=>{k.dispatch("channel/getInstances",{page:A.value,size:10})})),(e,u)=>{const d=s,m=a,v=t,g=n,f=r,h=l,k=o,I=c,C=i,F=p;return _(),b("div",null,[y(d,{topic:"deploy_app|start_app|stop_app",onmessage:R}),y("div",D,[y("div",E,[y(v,null,{default:T((()=>[y(m,{icon:"feather:search"},{default:T((()=>[j(y("input",{"onUpdate:modelValue":u[1]||(u[1]=e=>z.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[x,z.value]])])),_:1})])),_:1}),q]),w(N)&&0===w(N).data.length?(_(),b(g,{key:0,title:"没有数据",subtitle:"当前没有要显示的数据"})):(_(),b(h,{key:1,compact:""},{header:T((()=>[L])),body:T((()=>[y(f,{rows:w(N).data},null,8,["rows"])])),_:1})),w(N).page_info.count?(_(),b(k,{key:2,"item-per-page":w(N).page_info.size,"total-items":w(N).page_info.count,"current-page":w(A),"max-links-displayed":5},null,8,["item-per-page","total-items","current-page"])):V("",!0)]),y(F,{open:$.value,actions:"center",onClose:u[2]||(u[2]=e=>$.value=!1),title:"提示信息"},{content:T((()=>[y(I,{title:"您确认要删除此应用吗？"})])),action:T((()=>[y(C,{color:"primary",onClick:U,raised:""},{default:T((()=>[M])),_:1})])),_:1},8,["open"])])}}});O.__scopeId="data-v-055d2c94";const R={class:"page-title has-text-centered"},U={class:"menu-toggle has-chevron"},W=y("span",{class:"rotate"},[y("i",{class:"icon-line-top"}),y("i",{class:"icon-line-center"}),y("i",{class:"icon-line-bottom"})],-1),X=y("div",{class:"title-wrap"},[y("h1",{class:"title is-4"},"应用实例管理")],-1),G={class:"page-content-inner"},H={class:"breadcrumb-box"},J=y("i",{class:"iconify","data-icon":"feather:corner-down-left"},null,-1);var K=m({expose:[],setup(s){A({title:"应用实例管理"}),$((()=>{N.value="none"}));const a=v([{icon:"feather:home",hideLabel:!0,to:{name:"admin-users"}},{label:"应用实例管理",to:{name:"admin-instances"}}]);return(s,t)=>{const n=e,r=O;return _(),b("div",null,[y("div",R,[y("div",{class:"vuero-hamburger nav-trigger push-resize",onClick:t[1]||(t[1]=e=>w(P)("none"))},[y("span",U,[y("span",{class:[["none"===w(N)&&""],"icon-box-toggle"]},[W],2)])]),X]),y("div",G,[y("div",H,[a.value?(_(),b(n,{key:0,items:a.value,separator:"bullet","with-icons":""},null,8,["items"])):V("",!0),y("div",{onClick:t[2]||(t[2]=()=>s.router.back())},[J])]),y(r)])])}}});export default K;
